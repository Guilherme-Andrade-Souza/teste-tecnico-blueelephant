2025-12-15 22:36:16 | INFO | GeoAgent | Recebendo pergunta: 'Olá, quem é você?
2025-12-15 22:36:24 | ERROR | GeoAgent | Falha na execução do agente: 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/usage?tab=rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 20, model: gemini-2.5-flash
Please retry in 35.326568139s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerDayPerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 20
}
, retry_delay {
  seconds: 35
}
]
Traceback (most recent call last):
  File "/home/guilherme/Área de trabalho/teste-tecnico-blueelephant/app/agents/agent.py", line 88, in run_agent
    response = await executor.ainvoke(payload)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/guilherme/Área de trabalho/teste-tecnico-blueelephant/venv/lib/python3.12/site-packages/langchain/chains/base.py", line 214, in ainvoke
    raise e
  File "/home/guilherme/Área de trabalho/teste-tecnico-blueelephant/venv/lib/python3.12/site-packages/langchain/chains/base.py", line 205, in ainvoke
    await self._acall(inputs, run_manager=run_manager)
  File "/home/guilherme/Área de trabalho/teste-tecnico-blueelephant/venv/lib/python3.12/site-packages/langchain/agents/agent.py", line 1674, in _acall
    next_step_output = await self._atake_next_step(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/guilherme/Área de trabalho/teste-tecnico-blueelephant/venv/lib/python3.12/site-packages/langchain/agents/agent.py", line 1468, in _atake_next_step
    [
  File "/home/guilherme/Área de trabalho/teste-tecnico-blueelephant/venv/lib/python3.12/site-packages/langchain/agents/agent.py", line 1496, in _aiter_next_step
    output = await self._action_agent.aplan(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/guilherme/Área de trabalho/teste-tecnico-blueelephant/venv/lib/python3.12/site-packages/langchain/agents/agent.py", line 616, in aplan
    async for chunk in self.runnable.astream(
  File "/home/guilherme/Área de trabalho/teste-tecnico-blueelephant/venv/lib/python3.12/site-packages/langchain_core/runnables/base.py", line 3287, in astream
    async for chunk in self.atransform(input_aiter(), config, **kwargs):
  File "/home/guilherme/Área de trabalho/teste-tecnico-blueelephant/venv/lib/python3.12/site-packages/langchain_core/runnables/base.py", line 3270, in atransform
    async for chunk in self._atransform_stream_with_config(
  File "/home/guilherme/Área de trabalho/teste-tecnico-blueelephant/venv/lib/python3.12/site-packages/langchain_core/runnables/base.py", line 2163, in _atransform_stream_with_config
    chunk: Output = await asyncio.create_task(  # type: ignore[call-arg]
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/guilherme/Área de trabalho/teste-tecnico-blueelephant/venv/lib/python3.12/site-packages/langchain_core/runnables/base.py", line 3240, in _atransform
    async for output in final_pipeline:
  File "/home/guilherme/Área de trabalho/teste-tecnico-blueelephant/venv/lib/python3.12/site-packages/langchain_core/runnables/base.py", line 1314, in atransform
    async for ichunk in input:
  File "/home/guilherme/Área de trabalho/teste-tecnico-blueelephant/venv/lib/python3.12/site-packages/langchain_core/runnables/base.py", line 5312, in atransform
    async for item in self.bound.atransform(
  File "/home/guilherme/Área de trabalho/teste-tecnico-blueelephant/venv/lib/python3.12/site-packages/langchain_core/runnables/base.py", line 1332, in atransform
    async for output in self.astream(final, config, **kwargs):
  File "/home/guilherme/Área de trabalho/teste-tecnico-blueelephant/venv/lib/python3.12/site-packages/langchain_core/language_models/chat_models.py", line 485, in astream
    raise e
  File "/home/guilherme/Área de trabalho/teste-tecnico-blueelephant/venv/lib/python3.12/site-packages/langchain_core/language_models/chat_models.py", line 463, in astream
    async for chunk in self._astream(
  File "/home/guilherme/Área de trabalho/teste-tecnico-blueelephant/venv/lib/python3.12/site-packages/langchain_google_genai/chat_models.py", line 1088, in _astream
    async for value in super()._astream(
  File "/home/guilherme/Área de trabalho/teste-tecnico-blueelephant/venv/lib/python3.12/site-packages/langchain_core/language_models/chat_models.py", line 998, in _astream
    item = await run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/guilherme/Área de trabalho/teste-tecnico-blueelephant/venv/lib/python3.12/site-packages/langchain_core/runnables/config.py", line 590, in run_in_executor
    return await asyncio.get_running_loop().run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/guilherme/Área de trabalho/teste-tecnico-blueelephant/venv/lib/python3.12/site-packages/langchain_core/runnables/config.py", line 581, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/guilherme/Área de trabalho/teste-tecnico-blueelephant/venv/lib/python3.12/site-packages/langchain_google_genai/chat_models.py", line 1050, in _stream
    response: GenerateContentResponse = _chat_with_retry(
                                        ^^^^^^^^^^^^^^^^^
  File "/home/guilherme/Área de trabalho/teste-tecnico-blueelephant/venv/lib/python3.12/site-packages/langchain_google_genai/chat_models.py", line 198, in _chat_with_retry
    return _chat_with_retry(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/guilherme/Área de trabalho/teste-tecnico-blueelephant/venv/lib/python3.12/site-packages/tenacity/__init__.py", line 336, in wrapped_f
    return copy(f, *args, **kw)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/guilherme/Área de trabalho/teste-tecnico-blueelephant/venv/lib/python3.12/site-packages/tenacity/__init__.py", line 475, in __call__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/guilherme/Área de trabalho/teste-tecnico-blueelephant/venv/lib/python3.12/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/guilherme/Área de trabalho/teste-tecnico-blueelephant/venv/lib/python3.12/site-packages/tenacity/__init__.py", line 418, in exc_check
    raise retry_exc.reraise()
          ^^^^^^^^^^^^^^^^^^^
  File "/home/guilherme/Área de trabalho/teste-tecnico-blueelephant/venv/lib/python3.12/site-packages/tenacity/__init__.py", line 185, in reraise
    raise self.last_attempt.result()
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/guilherme/Área de trabalho/teste-tecnico-blueelephant/venv/lib/python3.12/site-packages/tenacity/__init__.py", line 478, in __call__
    result = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/guilherme/Área de trabalho/teste-tecnico-blueelephant/venv/lib/python3.12/site-packages/langchain_google_genai/chat_models.py", line 196, in _chat_with_retry
    raise e
  File "/home/guilherme/Área de trabalho/teste-tecnico-blueelephant/venv/lib/python3.12/site-packages/langchain_google_genai/chat_models.py", line 180, in _chat_with_retry
    return generation_method(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/guilherme/Área de trabalho/teste-tecnico-blueelephant/venv/lib/python3.12/site-packages/google/ai/generativelanguage_v1beta/services/generative_service/client.py", line 1122, in stream_generate_content
    response = rpc(
               ^^^^
  File "/home/guilherme/Área de trabalho/teste-tecnico-blueelephant/venv/lib/python3.12/site-packages/google/api_core/gapic_v1/method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/guilherme/Área de trabalho/teste-tecnico-blueelephant/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 294, in retry_wrapped_func
    return retry_target(
           ^^^^^^^^^^^^^
  File "/home/guilherme/Área de trabalho/teste-tecnico-blueelephant/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 156, in retry_target
    next_sleep = _retry_error_helper(
                 ^^^^^^^^^^^^^^^^^^^^
  File "/home/guilherme/Área de trabalho/teste-tecnico-blueelephant/venv/lib/python3.12/site-packages/google/api_core/retry/retry_base.py", line 214, in _retry_error_helper
    raise final_exc from source_exc
  File "/home/guilherme/Área de trabalho/teste-tecnico-blueelephant/venv/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 147, in retry_target
    result = target()
             ^^^^^^^^
  File "/home/guilherme/Área de trabalho/teste-tecnico-blueelephant/venv/lib/python3.12/site-packages/google/api_core/timeout.py", line 130, in func_with_timeout
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/guilherme/Área de trabalho/teste-tecnico-blueelephant/venv/lib/python3.12/site-packages/google/api_core/grpc_helpers.py", line 173, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.ResourceExhausted: 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/usage?tab=rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 20, model: gemini-2.5-flash
Please retry in 35.326568139s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerDayPerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-2.5-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 20
}
, retry_delay {
  seconds: 35
}
]
